{% extends "layout.html" %}
{% block title %}Index{% endblock %}
{% block head_tag %}
    {{ super() }}
{% endblock %}
{% block content %}
    <div id="result"></div>
    {% if data.login_session.access_token %}
      <div class="row">
        <div class="columns small-centered small-11 medium-centered medium-9 large-centered large-9">
           <form action="#" method="post" data-add-form>
            <input type="hidden" name="hash_key" value="{{data.login_session.hash_key}}">
            <select name="category" id="category">
              <option value="music">music</option>
              <option value="sports">sports</option>
              <option value="fashion">fashion</option>
              <option value="tech">tech</option>
            </select>
            <input type="text" name="title">
            <input type="text" name="description">
            <input type="submit" value="submit">
          </form>
        </div>
      </div>
      <div class="row">
        <div class="columns">
          <a href="/logout">Logout</a>
          <a href="/User/delete">Delete User</a>
        </div>
      </div>
    {% else %}
      <h1>Please Login to Use the System</h1>
      
    {% endif %}
    <script>
      $( document ).ready(function() {
          var $page = $("#content");
          var $form = $page.find("[data-add-form]");

          $form.on("submit", $(this), function(e){
            e.preventDefault();
            var data = $(this).serialize();

            $.ajax({
                url: '{{url_for("create_item")}}',
                type: 'POST',
                contentType: "application/x-www-form-urlencoded",
                data: data,
                success: function(result) {
                    // Do something with the result
                    $form.html("success! ;)")
                },
                fail: function(result){
                  console.log("api fail");
                }
            });
          });

      });

    </script>
{% endblock %}